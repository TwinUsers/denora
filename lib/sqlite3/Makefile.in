# Makefile for Denora.
#
# (c) 2004-2014 Denora Team
# Contact us at info@denorastats.org
#
# Please read COPYING and README for further details.
#
# Based on the original code of Anope by Anope Team.
# Based on the original code of Thales by Lucas.
#
# 
#


CCDV=@CCDV@
CC=$(CCDV)@CC@
INCLUDEDIR=../include 
DENORALIBS=@DENORALIBS@
BASEOPT=-O2
CFLAGS=@CFLAGS@
OPCFLAGS=@OPCFLAGS@
STRICT=@STRICT@
ANSI=-Wall -ansi -pedantic
PROFILE=-pg
LDPROFILE=
SHELL=/bin/sh
SUBDIRS=src
LIBDIRS=lib
BINDEST=@BINDEST@
DATDEST=@DATDEST@
INSTALL=@INSTALL@
RM=@RM@
CP=@CP@
TOUCH=@TOUCH@
MODULE_PATH=@MODULE_PATH@
MYSQL=@MYSQL@
MYSQL_CLIENT_LIBS=@MYSQL_CLIENT_LIBS@
LDFLAGS=@LDFLAGS@
RUNGROUP=@RUNGROUP@
SHARED=@SHARED@
RDYNAMNIC=@RDYNAMNIC@
MODULEFLAGS=@MODULEFLAGS@

OBJS =  sqlite3.o
        
SRCS =  sqlite3.c
        
INCLUDES = sqlite3.h sqlite3ext.h

MAKEARGS = 'CFLAGS=${CFLAGS}' 'CC=${CC}' 'DENORALIBS=${DENORALIBS}' \
	   'LDFLAGS=${LDFLAGS}' 'BINDEST=${BINDEST}' 'INSTALL=${INSTALL}' \
           'INCLUDEDIR=${INCLUDEDIR}' 'RM=${RM}' 'CP=${CP}' \
      	   'TOUCH=${TOUCH}' 'SHELL=${SHELL}' 'DATDEST=${DATDEST}' \
  	   'RUNGROUP=${RUNGROUP}' 'MODULE_PATH=${MODULE_PATH}' \
	   'SHARED=${SHARED}' 'MODULEFLAGS=${MODULEFLAGS}' 'RDYNAMNIC=${RDYNAMNIC}'


.c.o:
	$(CC) $(CFLAGS) ${DENORALIBS} -c $<

all: libsqlite3.la shell

distclean: spotless

libsqlite3.la:  $(OBJS)
	$(CC) -shared -Wl,-soname,libdenora_sqlite3.so -o libdenora_sqlite3.so  sqlite3.o

$(OBJS): Makefile
sqlite3.o:		sqlite3.c  $(INCLUDES)

shell:
	$(CC) $(CFLAGS) ${DENORALIBS} -c shell.c -o sqlite_shell

clean:
	rm -f *.o libdenora_sqlite3.so libdenora_sqlite3.la sqlite_shell a.out

spotless:
	rm -f *.o libdenora_sqlite3.so libdenora_sqlite3.la sqlite_shell a.out Makefile

install: DUMMY
	test -d ${BINDEST} || mkdir ${BINDEST}
	test -d ${BINDEST}/lib || mkdir ${BINDEST}/lib
	$(INSTALL) libdenora_sqlite3.so $(BINDEST)/lib/libdenora_sqlite3.so

DUMMY:
	